<!DOCTYPE html>
<html>
<head>
  <title>Stripe Checkout Form</title>
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <h1>Stripe Checkout Form</h1>
  <form id="payment-form">
    <input type="number" id="amount" placeholder="Enter Amount (in cents)">
    <div id="card-element"></div>
    <button id="submit">Pay</button>
    <div id="payment-result"></div>
  </form>

  <script>
    var stripe = Stripe('pk_test_51O2yBkGWcIk0Ah5OiC3hwdhobh4xTNHtQzuAfbmVtAl3RulksFTmdpsYjVLF5Zk7A7IMi7U7BoGYLedtB9a4wn0000RajrOOp9');
    var elements = stripe.elements();
    var cardElement = elements.create('card');
    cardElement.mount('#card-element');
    var form = document.getElementById('payment-form');

    form.addEventListener('submit', function(event) {
      event.preventDefault();
      var amount = document.getElementById('amount').value;
      createPaymentIntent(amount);
    });

    async function createPaymentIntent(amount) {
      var response = await fetch('/create-payment-intent', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ amount: amount }),
      });
      var intent = await response.json();

      if (intent.clientSecret) {
        confirmPayment(intent.clientSecret);
      } else {
        displayError(intent.error);
      }
    }

    async function confirmPayment(clientSecret) {
      var result = await stripe.confirmCardPayment(clientSecret, {
        payment_method: {
          card: cardElement,
        }
      });

      if (result.error) {
        displayError(result.error.message);
      } else if (result.paymentIntent && result.paymentIntent.status === 'succeeded') {
        displaySuccess('Payment succeeded');
      }
    }

    function displayError(message) {
      var resultContainer = document.getElementById('payment-result');
      resultContainer.innerText = 'Error: ' + message;
    }

    function displaySuccess(message) {
      var resultContainer = document.getElementById('payment-result');
      resultContainer.innerText = message;
    }
  </script>
</body>
</html>
